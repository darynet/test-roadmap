# Нормализация событий

В качестве информационной системы для сбора и нормализации логов будет выступать Ubuntu.
Установим и настроим auditd и будем брать логи с него.

Для операционных систем мы выделили следующие типы "базовых" событий:

| Тип события |
| ----------- |
| Успешные/неуспешные события входа/выхода пользователя |
| Создание/удаление групп пользователей                 |
| Создание/удаление пользователя                        |
| Запуск/остановка сервисов                             |
| Изменение доступа к объекту                           |

Борясь с желаниями на каждый тип события написать правило и написать одно громоздкое правило с кучей условий для всех событий, выделим группы типов событий.

## Общие поля для всех событий

Определим перечень полей, которые должны присутствовать в каждом правиле независимо от его типа.

Это будут:
- vendor - производитель ПО (в случае с Linux, это может быть opensource или unix_like)
- title - название ПО (опять же в случае с Linux, обобщим различные типы систем в одну unix_like)
- severity - важность события (low/medium/high/info)
- type - тип события
- status - статус события (success/failure)
- event_host - имя источника событий

При наличии сетевого взаимодействия
- src.ip - IP-адрес источника событий
- src.hostname - имя источника событий
- dst.ip - IP-адрес узла назначения
- dst.hostname - имя узла назначения

## Первая группа

Cобытия, связанные с логином/логаутом/аутентификацией пользователя.

[user_auth](./rules/user_auth.vrl)

Дополнительно должны быть поля:

| Название поля | Описание | 
| ------------- | -------- | 
| user.name     | логин пользователя |
| user.id       | идентификатор пользователя |
| logon_type    | тип входа в систему |

## Вторая группа

Cобытия, связанные с запуском/остановкой сервисов.

[service](./rules/service.vrl)

Дополнительно должны быть поля:

| Название поля | Описание | 
| ------------- | -------- |  
| service_name  | наименование сервиса | 
| user.name     | логин пользователя |
| user.id       | идентификатор пользователя |

## Третья группа 

Cобытия, связанные с изменением группы/пользователя.

[change_user_group](./rules/change_user_group.vrl)

Дополнительно должны быть поля:

| Название поля | Описание | 
| ------------- | -------- |  
| service_name  | наименование сервиса | 
| user.id       | идентификатор пользователя |
| object.id     | идентификатор созданного/удаленного пользователя/группы |

## Четвертая группа 

События, связанные с изменением прав доступа к объектам файловой системы.

[cmd_perm_mod](./rules/cmd_perm_mod.vrl)

Дополнительно должны быть поля:

| Название поля | Описание | 
| ------------- | -------- |  
| cmd     | выполняемая команда        | 
| user.id | идентификатор пользователя |